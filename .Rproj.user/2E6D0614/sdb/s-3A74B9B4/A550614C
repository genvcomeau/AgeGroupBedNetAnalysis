{
    "collab_server" : "",
    "contents" : "Bed.Net<- read.csv(\"C:/Users/Genevieve/Documents/R/MalariaBedNetSubset.csv\")\nBed.Net.High<- subset(Bed.Net, Bed.Net$High >0)\nBed.Net.Low<- subset(Bed.Net, Bed.Net$Low >0)\nlibrary(dplyr)\nHHTotLow<-\n  group_by(Bed.Net.Low, HHNo) %>% slice(which.max(HHMNo))\nHHTotLow<- HHTotLow[,c(\"HHNo\", \"HHMNo\")]\nNetTotLow<-\n  group_by(Bed.Net.Low, HHNo) %>% slice(which.max(NETNO))\n#bad estimate of HHsize, replaced by LNNET+NoNet\nHHNetsHi<-\n  merge(HHTotHi, NetTotHi, by.x = \"HHNo\", by.y = \"HHNo\")\nHHNetsHi$Netspp<- HHNetsHi$NETNO/HHNetsHi$HHMNo\nNetuseHHLow<- \n  merge(LNNETLow, NoNetLow, by.x = \"HHNo\", by.y = \"HHNo\")\nNetuseHHLow$HHtot<- \n  NetuseHHLow$`(sum(LNNET))` + NetuseHHLow$`(sum(NoNet))`\n#New estimate of HHsize, takes greater of two methods\nHHNetsLow$HHMNo<- pmax(HHNetsLow$HHMNo, HHNetsLow$HHtot)\nHHNetsLow$pLNNET<- \n  (HHNetsLow$`(sum(LNNET))`/(HHNetsLow$`(sum(LNNET))`+HHNetsLow$`(sum(NoNet))`))\nBed.Net.High[c(\"HHMNo\", \"NETNO\", \"Netspp\", \"pLNNET\")]<- NA\n#IMPORTANT HHMNo, NETNO in by land data != OG, rep total\nmlm.Hi<- \n  merge(Bed.Net.High, HHNetsHi, by.x= \"HHNo\", by.y= \"HHNo\")\nmlm.Lo$MAL12<- sub(\"N\", 0, mlm.Lo$MAL12)\n\nlogit.Hi<-\n  glm(LNNET ~ Age + Pregnant + Sex + NETDF + SHRSLP+ \n  SLPSTRUCT + MAL12 + HHMNo.y + Netspp.y, \n      data = mlm.Hi, family = \"binomial\")\nsummary(logit.Hi)\nlogit.Lo<-\n  glm(LNNET ~ Age + Pregnant + Sex + NETDF + SHRSLP+ \n        SLPSTRUCT + MAL12 + HHMNo + Netspp, \n      data = mlm.Lo, family = \"binomial\", na.action= na.exclude)\nsummary(logit.Lo)\nlogit.sig.Hi<-\n  glm(LNNET ~ Age + Sex + NETDF + \n        SLPSTRUCT + HHMNo.y + Netspp.y, \n      data = mlm.Hi, family = \"binomial\")\nlogit.sig.Lo<-\n  glm(LNNET ~ Sex + NETDF + Netspp, \n      data = mlm.Lo, family = \"binomial\", na.action= na.exclude)\n#assessment of model fit\nwith(logit.sig.Hi, null.deviance - deviance)\nwith(logit.sig.Hi, df.null - df.residual)\nwith(logit.sig.Hi, pchisq(null.deviance - deviance, \n                df.null - df.residual, lower.tail = FALSE))\n#OR and CIs\nconfint.default(logit.sig.Hi)\nexp(cbind(OR = coef(logit.sig.Hi), confint(logit.sig.Hi)))\n#Predicted probabilities by age\npredicted.Hi.F.ND1.M1<- with(mlm.Hi,\n     data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"F\"), NETDF = factor(1), SLPSTRUCT = factor(1), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.M.ND1.M1<- with(mlm.Hi,\n                             data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"M\"), NETDF = factor(1), SLPSTRUCT = factor(1), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.ND1.M1<- rbind(predicted.Hi.F.ND1.M1, predicted.Hi.M.ND1.M1)\npredicted.Hi.F.ND1.M0<- with(mlm.Hi,\n                             data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"F\"), NETDF = factor(1), SLPSTRUCT = factor(0), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.M.ND1.M0<- with(mlm.Hi,\n                             data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"M\"), NETDF = factor(1), SLPSTRUCT = factor(0), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.ND1.M0<- rbind(predicted.Hi.F.ND1.M0, predicted.Hi.M.ND1.M0)\npredicted.Hi.F.ND0.M1<- with(mlm.Hi,\n                             data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"F\"), NETDF = factor(0), SLPSTRUCT = factor(1), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.M.ND0.M1<- with(mlm.Hi,\n                             data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"M\"), NETDF = factor(0), SLPSTRUCT = factor(1), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.ND0.M1<- rbind(predicted.Hi.F.ND0.M1, predicted.Hi.M.ND0.M1)\npredicted.Hi.F.ND0.M0<- with(mlm.Hi,\n                                data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"F\"), NETDF = factor(0), SLPSTRUCT = factor(0), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.M.ND0.M0<- with(mlm.Hi,\n                             data.frame(Age = as.numeric(factor(1:98)), Sex = factor(\"M\"), NETDF = factor(0), SLPSTRUCT = factor(0), HHMNo.y = 6.366133, Netspp.y = 0.4632654))\npredicted.Hi.ND0.M0<- rbind(predicted.Hi.F.ND0.M0, predicted.Hi.M.ND0.M0)\nlogit.sig.Lo.pp<-\n  glm(LNNET ~ Age + Sex + NETDF + Netspp, \n      data = mlm.Lo, family = \"binomial\", na.action= na.exclude)\npredicted.Lo.M.ND1<- with(mlm.Lo,\n                      data.frame(Age = as.numeric(factor(1:98)), Sex = \"M\", NETDF = factor(1), Netspp =0.5425858))\npredicted.Lo.F.ND1<- with(mlm.Lo,\n                        data.frame(Age = as.numeric(factor(1:98)), Sex = \"F\", NETDF = factor(1), Netspp = 0.5425858))\npredicted.Lo.ND1 <- rbind(predicted.Lo.F.ND1, predicted.Lo.M.ND1)\npredicted.Lo.M.ND0<- with(mlm.Lo,\n                     data.frame(Age = as.numeric(factor(1:98)), Sex = \"M\", NETDF = factor(0), Netspp =0.5425858))\npredicted.Lo.F.ND0<- with(mlm.Lo,\n                          data.frame(Age = as.numeric(factor(1:98)), Sex = \"F\", NETDF = factor(0), Netspp =0.5425858))\npredicted.Lo.ND0 <- rbind(predicted.Lo.F.ND0, predicted.Lo.M.ND0)\n\npredicted.Hi.ND1.M1$AgeP <- predict(logit.sig.Hi, newdata = predicted.Hi.ND1.M1, type = \"response\")\npredicted.Hi.ND1.M0$AgeP <- predict(logit.sig.Hi, newdata = predicted.Hi.ND1.M0, type = \"response\")\npredicted.Hi.ND0.M1$AgeP <- predict(logit.sig.Hi, newdata = predicted.Hi.ND0.M1, type = \"response\")\npredicted.Hi.ND0.M0$AgeP <- predict(logit.sig.Hi, newdata = predicted.Hi.ND0.M0, type = \"response\")\npredicted.Lo.ND1$AgeP <- predict(logit.sig.Lo.pp, newdata = predicted.Lo.ND1, type = \"response\")\npredicted.Lo.ND0$AgeP <- predict(logit.sig.Lo.pp, newdata = predicted.Lo.ND0, type = \"response\")\n\n",
    "created" : 1469470859589.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1070544982",
    "id" : "A550614C",
    "lastKnownWriteTime" : 1469832929,
    "last_content_update" : 1469832929757,
    "path" : "~/AgeGroupBedNetAnalysis/AgeGroupMasterScript.R",
    "project_path" : "AgeGroupMasterScript.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}